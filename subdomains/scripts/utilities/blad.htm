<html>
<head>
<title>VML editor</title>

<!--[if IE ]>

<script language="JavaScript">

if(top == self){
location.replace('editor.htm');
} else {
document.writeln('<xml:namespace ns="urn:schemas-microsoft-com:vml" prefix="v"/>');
document.writeln('<style type="text/css">');
document.writeln('v\\:* { behavior: url(#default#VML);}');
document.writeln('</style>');
}

teller = 0;

function maak_vorm(vorm)
{
  teller++;
  X = event.clientX;
  Y = event.clientY;

  var vulling = (parent.document.forms[0].vulkleur.value == '')? '<v:fill on="false" />': '<v:fill color="' + parent.document.forms[0].vulkleur.value + '" />';  
  var dikte = parent.document.forms[0].lijndikte.value;
  var rand = (parent.document.forms[0].randkleur.value == '')? '<v:stroke on="false" />': '<v:stroke weight="' + dikte + '" color="' + parent.document.forms[0].randkleur.value + '" />';

  var vormen = new Array(); 
  vormen['vrijevorm'] = '<v:shape id="nr' + teller + '" style="position: absolute; left: 0px; top: 0px; width: ' + document.body.clientWidth + 'px; height: ' + document.body.clientHeight + 'px;" coordsize="' + document.body.clientWidth + ',' + document.body.clientHeight + '"><v:path v="m ' + X + ',' + Y + ' l ' + X + ',' + Y + ' e" />' + vulling + rand + '</v:shape>';
  vormen['ovaal'] = '<v:oval id="nr' + teller + '" style="position: absolute; left: ' + X + '; top: ' + Y + '; width: 1px; height: 1px;" >' + vulling + rand + '</v:oval>';  
  vormen['rechthoek'] = '<v:rect id="nr' + teller + '" style="position: absolute; left: ' + X + '; top: ' + Y + '; width: 1px; height: 1px;" >' + vulling + rand + '</v:rect>';
  vormen['rondhoek'] = '<v:roundrect id="nr' + teller + '" style="position: absolute; left: ' + X + '; top: ' + Y + '; width: 1px; height: 1px;" >' + vulling + rand + '</v:roundrect>';

  document.body.insertAdjacentHTML('beforeend', (vormen[vorm] + '<br>'));
  document.onmousemove = (vorm == 'vrijevorm')? teken_vrijevorm: teken_vastevorm;
}

function teken_vrijevorm()
{
  var pad = document.getElementById('nr' + teller).firstChild;
  pad.setAttribute('v', (pad.getAttribute('v').replace('e','') + ' ' + event.clientX + ',' + event.clientY + ' e')); 
}

function teken_vastevorm()
{
  var vorm = document.getElementById('nr' + teller);
  var verschil_X = event.clientX - X;
  var verschil_Y = event.clientY - Y;

    if(verschil_X < 0){
    vorm.style.left = (X + verschil_X) + 'px';
    vorm.style.width = -verschil_X + 'px';
    } else {
    vorm.style.width = verschil_X + 'px';
    }

    if(verschil_Y < 0){
    vorm.style.top = (Y + verschil_Y) + 'px';
    vorm.style.height = -verschil_Y + 'px';
    } else {
    vorm.style.height = verschil_Y + 'px';
    }
}

function eindig_vorm()
{
  if(parent.document.forms[0].anti_alias.checked){
  document.getElementById('nr' + teller).style.antialias = 'true';
  }

  document.onmousemove = niks; 
}

function niks(){ return false;}

window.onerror = function(){ return true;}

if(top != self){ 
document.onmousedown = function(){ maak_vorm(parent.document.forms[0].gereedschap.options[parent.document.forms[0].gereedschap.selectedIndex].value);}
document.onmouseup = eindig_vorm;
}

document.onselectstart = niks;
document.oncontextmenu = niks;

</script>

<![endif]-->

</head>
<body scroll="no" bgcolor="#FFFFFF">

<![if !IE ]>
<h4><font face="Arial, Helvetica">This page can only be viewed in Internet Explorer 5+ (Windows).</font></h4>
<![endif]>

</body>
</html>
